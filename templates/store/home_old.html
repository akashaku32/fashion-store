{% extends 'base.html' %}
{% load static %}

{% block title %}Luna & Lace - Luxurious Women's Fashion{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section position-relative overflow-hidden">
    <div class="hero-slider">
        <div class="hero-slide active">
            <div class="hero-bg" style="background: linear-gradient(rgba(212, 165, 116, 0.8), rgba(168, 181, 160, 0.8)), url('https://images.unsplash.com/photo-1441986300917-64674bd600d8?w=1920&h=1080&fit=crop'); background-size: cover; background-position: center;"></div>
            <div class="container">
                <div class="row align-items-center min-vh-100">
                    <div class="col-lg-6">
                        <div class="hero-content text-white">
                            <h1 class="display-4 fw-bold mb-4">Luna & Lace</h1>
                            <p class="lead mb-4">Where celestial elegance meets earthly grace. Discover our curated collection of luxurious women's fashion that celebrates your unique beauty.</p>
                            <a href="{% url 'store:product_list' %}" class="btn btn-light btn-lg px-5 py-3 elegant-btn">
                                <i class="fas fa-moon me-2"></i>Explore Collection <i class="fas fa-arrow-right ms-2"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="hero-shapes">
        <div class="shape shape-1"></div>
        <div class="shape shape-2"></div>
        <div class="shape shape-3"></div>
    </div>
</section>

<!-- Features Section -->
<section class="py-5 luxury-section">
    <div class="container">
        <div class="row g-4">
            <div class="col-md-4">
                <div class="feature-card elegant-card soft-rounded text-center p-4 soothing-hover">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-shipping-fast fa-3x text-primary"></i>
                    </div>
                    <h5 class="fw-bold">Free Shipping</h5>
                    <p class="text-muted">Free shipping on orders over $100</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="feature-card elegant-card soft-rounded text-center p-4 soothing-hover">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-undo fa-3x text-primary"></i>
                    </div>
                    <h5 class="fw-bold">Easy Returns</h5>
                    <p class="text-muted">30-day return policy</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="feature-card elegant-card soft-rounded text-center p-4 soothing-hover">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-headset fa-3x text-primary"></i>
                    </div>
                    <h5 class="fw-bold">24/7 Support</h5>
                    <p class="text-muted">Customer service always available</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Categories Section -->
<section class="py-5">
    <div class="container">
        <div class="row mb-5">
            <div class="col-12 text-center">
                <h2 class="display-5 fw-bold mb-3">Shop by Category</h2>
                <p class="lead text-muted">Explore our carefully curated collections</p>
            </div>
        </div>
        <div class="row g-4">
            {% for category in categories %}
            <div class="col-lg-4 col-md-6">
                <div class="category-card luxury-product-card position-relative overflow-hidden">
                    <div class="category-image">
                        {% if category.image %}
                        <img src="{{ category.image_source }}" alt="{{ category.name }}" class="img-fluid">
                        {% else %}
                        <div class="category-placeholder bg-gradient-primary d-flex align-items-center justify-content-center">
                            <i class="fas fa-tshirt fa-4x text-white"></i>
                        </div>
                        {% endif %}
                    </div>
                    <div class="category-overlay">
                        <div class="category-content text-center text-white">
                            <h4 class="fw-bold mb-3">{{ category.name }}</h4>
                            <a href="{% url 'store:product_list' %}?category={{ category.slug }}" class="btn btn-light">
                                Shop Now
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Featured Products Section -->
<section class="py-5 bg-light">
    <div class="container">
        <div class="row mb-5">
            <div class="col-12 text-center">
                <h2 class="display-5 fw-bold mb-3">Featured Products</h2>
                <p class="lead text-muted">Handpicked items just for you</p>
            </div>
        </div>
        <div class="row g-4">
            {% for product in featured_products %}
            <div class="col-lg-3 col-md-6">
                <div class="product-card luxury-product-card overflow-hidden h-100">
                    <div class="product-image position-relative">
                        {% if product.images.first %}
                        <img src="{{ product.images.first.image_source }}" alt="{{ product.name }}" class="img-fluid">
                        {% else %}
                        <div class="product-placeholder bg-light d-flex align-items-center justify-content-center">
                            <i class="fas fa-image fa-3x text-muted"></i>
                        </div>
                        {% endif %}
                        {% if product.discount_price %}
                        <div class="discount-badge">
                            -{{ product.discount_percentage }}%
                        </div>
                        {% endif %}
                        <div class="product-actions">
                            <a href="{% url 'store:product_detail' product.slug %}" class="btn btn-primary btn-sm">
                                <i class="fas fa-eye"></i>
                            </a>
                            <button class="btn btn-outline-primary btn-sm add-to-cart" data-product-id="{{ product.id }}">
                                <i class="fas fa-shopping-cart"></i>
                            </button>
                        </div>
                    </div>
                    <div class="product-content p-4">
                        <h6 class="product-title fw-bold mb-2">{{ product.name }}</h6>
                        <div class="product-price mb-3">
                            {% if product.discount_price %}
                            <span class="current-price fw-bold text-primary">${{ product.discount_price }}</span>
                            <span class="original-price text-muted text-decoration-line-through ms-2">${{ product.price }}</span>
                            {% else %}
                            <span class="current-price fw-bold text-primary">${{ product.price }}</span>
                            {% endif %}
                        </div>
                        <div class="product-meta text-muted small">
                            <span class="me-3"><i class="fas fa-palette me-1"></i>{{ product.color }}</span>
                            <span><i class="fas fa-ruler me-1"></i>{{ product.size }}</span>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        <div class="row mt-5">
            <div class="col-12 text-center">
                <a href="{% url 'store:product_list' %}" class="btn btn-primary btn-lg px-5">
                    View All Products <i class="fas fa-arrow-right ms-2"></i>
                </a>
            </div>
        </div>
    </div>
</section>

<!-- Newsletter Section -->
<section class="py-5 bg-primary text-white">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6">
                <h3 class="fw-bold mb-3">Stay in Style</h3>
                <p class="mb-0">Subscribe to our newsletter and be the first to know about new arrivals, exclusive offers, and fashion tips.</p>
            </div>
            <div class="col-lg-6">
                <form method="post" action="{% url 'store:newsletter_signup' %}" class="d-flex">
                    {% csrf_token %}
                    <input type="email" name="email" class="form-control me-3" placeholder="Enter your email address" required>
                    <button type="submit" class="btn btn-light">
                        Subscribe <i class="fas fa-paper-plane ms-2"></i>
                    </button>
                </form>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Add to cart functionality
    document.querySelectorAll('.add-to-cart').forEach(button => {
        button.addEventListener('click', function() {
            const productId = this.dataset.productId;
            fetch(`/add-to-cart/${productId}/`, {
                method: 'POST',
                headers: {
                    'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value,
                    'X-Requested-With': 'XMLHttpRequest',
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: 'quantity=1'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Update cart count
                    const cartBadge = document.querySelector('.badge');
                    if (cartBadge) {
                        cartBadge.textContent = data.cart_items_count;
                    }
                    // Show success message
                    showNotification('Product added to cart!', 'success');
                }
            })
            .catch(error => {
                showNotification('Error adding product to cart', 'error');
            });
        });
    });
});

function showNotification(message, type) {
    const notification = document.createElement('div');
    notification.className = `alert alert-${type === 'success' ? 'success' : 'danger'} alert-dismissible fade show position-fixed`;
    notification.style.cssText = 'top: 100px; right: 20px; z-index: 9999; min-width: 300px;';
    notification.innerHTML = `
        ${message}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    `;
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.remove();
    }, 3000);
}
</script>
{% endblock %}
